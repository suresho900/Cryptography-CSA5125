#include <stdio.h>
#include <string.h>
#include <ctype.h>
char m[5][6] = {
    {'M','F','H','I','J','K'},
    {'U','N','O','P','Q',' '},
    {'Z','V','W','X','Y',' '},
    {'E','L','A','R','G',' '},
    {'D','S','T','B','C',' '}
};
void find(char ch, int *r, int *c) {
    if (ch == 'J') ch = 'I';
    for (int i = 0; i < 5; i++)
        for (int j = 0; j < 6; j++)
            if (m[i][j] == ch) { *r = i; *c = j; return; }
}
void prep(char *s) {
    char t[200]; int i, j = 0;
    for (i = 0; s[i]; i++)
        if (isalpha(s[i])) t[j++] = toupper(s[i] == 'J' ? 'I' : s[i]);
    if (j % 2) t[j++] = 'X'; t[j] = '\0';
    strcpy(s, t);
}
void enc(char *in, char *out) {
    prep(in); int i, r1, c1, r2, c2;
    for (i = 0; in[i]; i += 2) {
        find(in[i], &r1, &c1); find(in[i+1], &r2, &c2);
        if (r1 == r2) out[i] = m[r1][(c1+1)%6], out[i+1] = m[r2][(c2+1)%6];
        else if (c1 == c2) out[i] = m[(r1+1)%5][c1], out[i+1] = m[(r2+1)%5][c2];
        else out[i] = m[r1][c2], out[i+1] = m[r2][c1];
    }
    out[i] = '\0';
}
int main() {
    char msg[200] = "Must see you over Cadogan West. Coming at once.", ciph[200];
    enc(msg, ciph);
    printf("Ciphertext: %s\n", ciph);
    return 0;
}
Output:-
Ciphertext: UZTBDLGZPNNWLGTGTU ROVLDB UHFP RHWQSRZ.
